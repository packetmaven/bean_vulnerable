package com.beanvulnerable.aeg.domain;

import java.util.ArrayList;
import java.util.List;

public class Vulnerability {
    private final String id;
    private final String sourceId;
    private final String sinkId;
    private final String sinkType;
    private final String vulnerabilityType;
    private final String description;
    private final List<Constraint> constraints;

    public Vulnerability(String sourceId, String sinkId, String sinkType, List<Constraint> constraints) {
        this(sourceId, sinkId, sinkType, sinkType, "", constraints);
    }

    public Vulnerability(String sourceId, String sinkId, String sinkType,
                         String vulnerabilityType, String description,
                         List<Constraint> constraints) {
        this.sourceId = sourceId;
        this.sinkId = sinkId;
        this.sinkType = sinkType;
        this.vulnerabilityType = vulnerabilityType != null ? vulnerabilityType : sinkType;
        this.description = description != null ? description : "";
        this.id = buildId(sourceId, sinkId, sinkType);
        this.constraints = constraints != null ? new ArrayList<>(constraints) : new ArrayList<>();
    }

    private String buildId(String sourceId, String sinkId, String sinkType) {
        String src = sourceId != null ? sourceId : "source";
        String sink = sinkId != null ? sinkId : "sink";
        String type = sinkType != null ? sinkType : "unknown";
        return src + "->" + sink + ":" + type;
    }

    public String getId() {
        return id;
    }

    public String getSourceId() {
        return sourceId;
    }

    public String getSinkId() {
        return sinkId;
    }

    public String getSinkType() {
        return sinkType;
    }

    public String getVulnerabilityType() {
        return vulnerabilityType;
    }

    public String getDescription() {
        return description;
    }

    public List<Constraint> getConstraints() {
        return constraints;
    }
}
